# 1장 리팩토링이란?

------

리팩토링은 코드를 변경하는 것이 아니다.

정확하게는 코드를 변경하는 것은 방법중 하나지만, '코드 동작'을 바꿔선 안 된다.



------

### 1.1 코드 동작이 변하지 않는다는 것을 어떻게 보장할 수 있을까?

- 구현 세부 사항
- 불특정하고 검증되지 않은 동작
- 성능

테스트와 버전 관리를 사용, 즉 코드 변경과 안정성을 보장하는 자동화 도구를 사용

##### 리팩토링한 코드가 제대로 실행되지 않은 때 변경 전 코드로 되돌릴 수 있도록 반드시 버전 관리를 사용하여 단계적으로 리팩토링을 진행한다.



### 1.2 구현 세부 사항에 관심을 두면 어떨까?

------

**구현 세부 사항**이란, **코드가 소비되는 코드에 의해 생성되는 동작**을 말한다.

```Javascript
function byTwo (number) {
	return number * 2;
}

function byTwo (number) {
    return number << 1;
}
```

위에 두 함수 모두 동작을 할 것이다. 둘다 같은 결과를 반환할 것이고, 함수 내부 동작보단 해당 결과 값에 더욱 관심을 갖을 것이다.

하지만, 두 번째 함수는 값이 너무 커지면 쉬프트 연산자로 부터 문제가 생길 것이다. 그리고 우리는 구현 세부 사항에 신경을 쓰는 것이 아닌 당연히 결과값이 잘 못된 것이라고 생각할겁니다.

이 사례로 **테스트 케이스가 처음 생각한 것보다 더 많은 경우를 포함해야 한다는 것**을 알 수 있다.



### 1.3 불특정하고 검증되지 않은 동작에 관심을 두면 어떨까?

------

코드 구체화 및 검증은 해당 동작에 관심을 보이려는 노력.

실행 테스트나 수동 절차, 동작법에 대해 최소한의 설명이 없으면 기본적으로 해당 코드를 검증할 수 없는 것을 의미

```Javascript
//테스트나 문서 및 관리 운용에 대한 지원이 없는 코드
function doesThings (args, callback) {
    doesOtherThings(args);
    doesOtherOtherThings(args, callback);
    
    return 5;
}
```

위 함수의 동작이 바뀌었다면 관심을 가졌을까? 대답은 No에 가까울 것이다.

그렇다면, 위 함수를 이해할 수 없으니 중요하지 않다고 판단해도 될까? 이 대답은 확실히 No다.

##### 자동이나 수동 여부에 상관없이 테스트를 거치지 않은 코드는 리팩토링할 수 없다.



### 1.4 성능에 관심을 두면 어떨까?

------

보통 초기에는 성능보단 기댓값을 가져다주는 입력 값에 더 관심을 두곤 한다. 즉, **사용자는 성능보단 동작과 기댓값에 더 중점을 둔다.**

